---
title: Architecture
description: dbLinter Architecture
sidebar:
  order: 40
---

## Big Picture

Here is an overview of the dbLinter components and their major data flows.

```mermaid
flowchart
    subgraph Cloud ["â›… Cloud"]
        Repo[(Repo)] <--> GUI([Web GUI])
        Repo <--> REST-API(REST-API)
        REST-API --rules--> Rule-Site([Static
                                      Rule Site])
        click Repo "#repo"
        click GUI "#web-gui"
        click REST-API "#rest-api"
        click Rule-Site "#static-rule-site"
    end

    subgraph Client ["ðŸ’» Localâ €â €â €â €â €â €â €"]
        LS[[Language
            Server]] <--> CLI(CLI)
        LS <--> VSCode(VS Code
                       Extension)
        LS <--> SonarQube(SonarQube
                          Plugin)
        click LS "#language-server"
        click CLI "#cli"
        click VSCode "#vs-code-extension"
        click SonarQube "#sonarqube-plugin"
    end

    REST-API --config---> LS
    LS --ignore--> REST-API
```

## Cloud Components

Cloud components are installed on servers managed by United Codes and Grisselbav.

### Repo

The dbLinter repository is implemented using the [PinkDB paradigm](https://www.salvis.com/blog/2018/07/18/the-pink-database-paradigm-pinkdb/)
with an [Oracle AI Database 26ai](https://docs.oracle.com/en/database/oracle/oracle-database/26/index.html).
For example, this means that the [Web GUI](#web-gui) and the [REST-API](#rest-api) access the database via dedicated users
based on the [principle of least privileges](https://en.wikipedia.org/wiki/Principle_of_least_privilege).

### Web GUI

The dbLiner Web GUI is built with [Oracle APEX](https://apex.oracle.com/en/). It is used for managing tenant-specific data,
such as rules, configurations and user access.

For more information, see [Web GUI](/dbLinter/tools/web-gui) in the Tools section.

### REST-API

The dbLinter REST-API is a [SpringBoot](https://spring.io/projects/spring-boot) application. It is an internal API
used only by other dbLinter components. The following subjects are covered:

| Subject | Communication via | Description                                                                     |
| ------- | ----------------- | ------------------------------------------------------------------------------- |
| Email   | JMS               | Sending e-mails synchronously and asynchronously via Oracle AQ and Spring Mail. |
| Rules   | REST              | Providing the rules for generating the static rules site.                       |
| Config  | REST              | Get the configuration required to run checks and SQL-based tests.               |
| Ignore  | REST              | Add tests to be ignored to prevent them from being reported in subsequent runs. |

All REST-API calls require authentication using an API key consisting of the tenant name, the user's email address and a personal access token.

### Static Rule Site

The dbLinter static rule site is generated daily with [Svelte](https://svelte.dev/) using the latest public rules from the dbLinter repository.
This website makes the dbLinter rules available independently of the dbLinter tool suite.

During the preview phase, this static rule site was used to reference the rules in the `Problems` panel of the [VS Code Extension](#vs-code-extension),
and in reports produced by the [CLI](#cli).

After the preview phase, the dbLinter tools will no longer use the static rule site.

## Local Components

Local components run on machines controlled by the dbLinter users.

### Language Server

The dbLinter Language Server implements a subset of [Microsoft's Language Server Protocol (LSP)](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/)
using [Eclipse LSP4J](https://projects.eclipse.org/projects/technology.lsp4j). The Language Server is embedded in the [CLI](#cli) and the [SonarQube Plugin](#sonarqube-plugin).

The following LSP methods are implemented:

| Method                                                                                                                                                           | Description                                             |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| [initialize](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#initialize)                                             | Initialize the language server.                         |
| [shutdown](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#shutdown)                                                 | Close the dbLinter session and free resources.          |
| [exit](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#exit)                                                         | Exit the language server.                               |
| [workspace/didChangeConfiguration](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#workspace_didChangeConfiguration) | Apply a configuration according to the client settings. |
| [textDocument/diagnostic](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#textDocument_diagnostic)                   | Get the issues for an URI.                              |
| [textDocument/didOpen](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#textDocument_didOpen)                         | Add the content of an URI to the cache.                 |
| [textDocument/didChange](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#textDocument_didChange)                     | Update the cache with the content of the changed URI.   |
| [textDocument/didClose](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#textDocument_didClose)                       | Remove the URI from the cache.                          |
| [textDocument/codeAction](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#textDocument_codeAction)                   | Get the quick fixes for a document range of an URI.     |
| [codeAction/resolve](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeAction_resolve)                             | Apply a quick fix.                                      |

Additionally, the Language Server implements the following non-standard JSON-RPC methods used by the [VS Code Extension](#vs-code-extension),
the [CLI](#cli) and the [SonarQube Plugin](#sonarqube-plugin):

| Method                     | Description                                                              |
| -------------------------- | ------------------------------------------------------------------------ |
| dbLinter/tests             | Get all SQL-based tests that are part of the configuration.              |
| dbLinter/runTest           | Run a SQL-based test.                                                    |
| dbLinter/ignoreTestResults | Save test results to be ignored in the configuration.                    |
| dbLinter/hasFeature        | Check if a dbLinter feature is available.                                |
| dbLinter/isConfigLoaded    | Check if the configuration is loaded.                                    |
| dbLinter/isUriIncluded     | Check if a given URI should be processed according to the configuration. |
| dbLinter/plsqlMetric       | Get the PL/SQL metrics for a given URI.                                  |
| dbLinter/rules             | Get the rules defined in the configuration.                              |

### CLI

tbd

### VS Code Extension

tbd

### SonarQube Plugin

tbd
